---
title: "Portfolio Flow"
author: "Margaret Reed"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load-pkgs}
library(tidyverse)
library(janitor)
```

```{r clean-data-hungary}
hungary_data <- read_csv("../data/Portfolio Flows/NetPortfolioFlowsHungary_raw.csv", skip = 4, col_select = 1:3) %>% rename("date" = "...1")

hungary_data <- hungary_data %>%
  clean_names() %>%
  mutate(
    net_flow = equity + debt,
    date = paste0("01 ", date),
    date = str_replace(date, "-", " "),
    date = as.Date(date, format = "%d %b %y"),
    ) %>%
  filter(!is.na(net_flow))

write_csv(hungary_data, "../data/Portfolio Flows/portfolio_flows_hungary.csv")
```

```{r clean-data-poland}
poland_data <- read_csv("../data/Portfolio Flows/NetPortfolioFlowsPoland_raw.csv", skip = 4, col_select = 1:3) %>% rename("date" = "...1")

poland_data <- poland_data %>%
  clean_names() %>%
  mutate(
    net_flow = equity + debt,
    date = paste0("01 ", date),
    date = str_replace(date, "-", " "),
    date = as.Date(date, format = "%d %b %y"),
    ) %>%
  filter(!is.na(net_flow))

write_csv(poland_data, "../data/Portfolio Flows/portfolio_flows_poland.csv")
```

```{r clean-data-romania}
romania_data <- read_csv("../data/Portfolio Flows/NetPortfolioFlowsRomania_raw.csv", skip = 4, col_select = 1:3) %>% rename("date" = "...1")

romania_data <- romania_data %>%
  clean_names() %>%
  mutate(
    net_flow = equity + debt,
    date = paste0("01 ", date),
    date = str_replace(date, "-", " "),
    date = as.Date(date, format = "%d %b %y"),
    ) %>%
  filter(!is.na(net_flow))

write_csv(romania_data, "../data/Portfolio Flows/portfolio_flows_romania.csv")
```

